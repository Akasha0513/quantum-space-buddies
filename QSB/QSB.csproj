<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <LangVersion>9</LangVersion>
    <AssemblyTitle>Quantum Space Buddies</AssemblyTitle>
    <Company>Henry Pointer, Aleksander Waage, Ricardo Lopes</Company>
    <Product>Quantum Space Buddies</Product>
    <NeutralLanguage>en-GB</NeutralLanguage>
    <Description>Multiplayer mod for Outer Wilds</Description>
    <Copyright>Copyright © Henry Pointer, Aleksander Waage, Ricardo Lopes 2020-2021</Copyright>
    <GenerateAssemblyInfo>false</GenerateAssemblyInfo>
    <OutputPath>bin\$(Configuration)\</OutputPath>
    <AppendTargetFrameworkToOutputPath>false</AppendTargetFrameworkToOutputPath>
    <AppendRuntimeIdentifierToOutputPath>false</AppendRuntimeIdentifierToOutputPath>
  </PropertyGroup>
  <PropertyGroup>
    <ProjectGuid>{1F00090A-C697-4C55-B401-192F3CFB9DC2}</ProjectGuid>
    <TargetFramework>net48</TargetFramework>
    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugType>full</DebugType>
    <Optimize>true</Optimize>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
  </PropertyGroup>
  <PropertyGroup>
    <RunPostBuildEvent>OnBuildSuccess</RunPostBuildEvent>
  </PropertyGroup>
  <PropertyGroup>
    <PostBuildEvent Condition="$(CopyToAssets) == 1">
:: copy dll to unity project
copy /y "$(TargetPath)" $(UnityAssetsDir)
:: copy quantumunet to unity project
copy /y "$(OwmlDir)\Mods\$(ProjectName)\QuantumUNET.dll" $(UnityAssetsDir)
:: copy game assembly to unity project
copy /y "$(GameDir)\OuterWilds_Data\Managed\Assembly-CSharp.dll" $(UnityAssetsDir)
copy /y "$(GameDir)\OuterWilds_Data\Managed\Assembly-CSharp-firstpass.dll" $(UnityAssetsDir)
copy /y "$(GameDir)\OuterWilds_Data\Managed\Unity.InputSystem.dll" $(UnityAssetsDir)
copy /y "$(GameDir)\OuterWilds_Data\Managed\EOS-SDK.dll" $(UnityAssetsDir)
copy /y "$(GameDir)\OuterWilds_Data\Managed\UniSense.dll" $(UnityAssetsDir)

:: copy owml files to unity project
copy /y "$(OwmlDir)\Autofac.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\Newtonsoft.Json.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\0Harmony.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\MonoMod.Utils.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\MonoMod.RuntimeDetour.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\Mono.Cecil.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\Mono.Cecil.Mdb.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\Mono.Cecil.Pdb.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\Mono.Cecil.Rocks.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\dnpatch.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\dnlib.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\Gameloop.Vdf.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\NAudio-Unity.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\OWML.Common.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\OWML.ModHelper.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\OWML.ModHelper.Assets.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\OWML.ModHelper.Events.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\OWML.ModHelper.Menus.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\OWML.ModHelper.Input.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\OWML.ModHelper.Interaction.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\OWML.Utils.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\OWML.Common.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\OWML.Logging.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\OWML.ModLoader.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\OWML.Patcher.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\OWML.GameFinder.dll" $(UnityAssetsDir)
copy /y "$(OwmlDir)\OWML.Abstractions.dll" $(UnityAssetsDir)
</PostBuildEvent>
  </PropertyGroup>
  <ItemGroup>
    <None Include="default-config.json">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </None>
    <None Include="manifest.json">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </None>
  </ItemGroup>
  <ItemGroup>
    <Reference Include="UnityEngine.Networking, Version=1.0.0.0, Culture=neutral, processorArchitecture=MSIL">
      <HintPath>..\QSB\lib\UnityEngine.Networking.dll</HintPath>
      <SpecificVersion>False</SpecificVersion>
    </Reference>
    <PackageReference Include="OuterWildsGameLibs" Version="*" IncludeAssets="compile" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\QuantumUNET\QuantumUNET.csproj" />
  </ItemGroup>
  <ItemGroup>
    <PackageReference Include="HarmonyX" Version="2.*" IncludeAssets="compile" />
    <PackageReference Include="OWML" Version="2.*" IncludeAssets="compile" />
  </ItemGroup>
  <ItemGroup>
    <None Update="AssetBundles\*">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
  </ItemGroup>
</Project>